<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Travel - L·ªô tr√¨nh th√¥ng minh</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="control-panel">
        <div id="panel-header">
            <div style="flex: 1;">
                <h2><i class="fas fa-paper-plane"></i> Smart Travel</h2>
                <p>Thi·∫øt k·∫ø l·ªô tr√¨nh th√¥ng minh c·ªßa b·∫°n</p>
            </div>
        </div>

        <div id="panel-content">
            <div id="route-builder">
                <form id="route-form">
                    <div class="input-group">
                        <label>ƒêi·ªÉm kh·ªüi h√†nh</label>
                        <div class="input-wrapper">
                            <i class="fas fa-map-marker-alt" style="color:var(--danger-color);"></i>
                            <input type="text" id="start-point" placeholder="Nh·∫≠p ƒëi·ªÉm ƒëi..." autocomplete="off">
                            <div id="start-suggestions-list" class="autocomplete-dropdown"></div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>ƒêi·ªÉm ƒë·∫øn</label>
                        <div class="input-wrapper">
                            <i class="fas fa-location-dot" style="color:var(--primary-color);"></i>
                            <input type="text" id="end-point" placeholder="Nh·∫≠p ƒëi·ªÉm ƒë·∫øn..." autocomplete="off">
                            <div id="end-suggestions-list" class="autocomplete-dropdown"></div>
                        </div>
                    </div>

                    <div class="row-group" style="align-items: flex-start;">
                        <div class="input-group" style="flex: 1.2;">
                            <label>B√°n k√≠nh t√¨m ki·∫øm</label>
                            <div class="budget-wrapper">
                                <div class="values">
                                    <span id="radius-display">20</span> km
                                </div>
                                <div class="slider-container">
                                    <div class="slider-track" id="radius-track"></div>
                                    <input type="range" min="1" max="100" value="20" id="radius-slider">
                                </div>
                            </div>
                        </div>

                        <div class="input-group" style="flex: 0.8;">
                            <label>Ph∆∞∆°ng ti·ªán</label>
                            <div class="input-wrapper">
                                <i class="fas fa-car-side"></i>
                                <select id="vehicle-type">
                                    <option value="motorbike">Xe m√°y</option>
                                    <option value="car" selected>√î t√¥</option>
                                    <option value="walking">ƒêi b·ªô</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row-group" style="align-items: flex-start;">
                        <div class="input-group" style="flex: 0.8;">
                            <label>S·ªë ƒëi·ªÉm gh√©</label>
                            <div class="input-wrapper">
                                <i class="fas fa-list-ol"></i>
                                <input type="number" id="waypointCount" value="2" min="0" max="10">
                            </div>
                        </div>

                        <div class="input-group" style="flex: 1.2;">
                            <label>Ng√¢n s√°ch (VNƒê)</label>
                            <div class="budget-wrapper">
                                <div class="values">
                                    <span id="range1">0ƒë</span> - <span id="range2">5.0tr</span>
                                </div>
                                <div class="slider-container">
                                    <div class="slider-track" id="budget-track"></div>

                                    <input type="range" min="0" max="10000000" value="0" step="100000" id="slider-1">
                                    <input type="range" min="0" max="10000000" value="5000000" step="100000" id="slider-2">
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="primary-btn">
                        T·∫°o L·ªô Tr√¨nh <i class="fas fa-arrow-right"></i>
                    </button>
                </form>
            </div>

            <div id="route-summary" style="display:none;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding:10px; border-bottom:1px solid #eee;">
                    <h3 style="margin:0; font-size:1rem; font-weight:700;">L·ªô tr√¨nh chi ti·∫øt</h3>
                    <button id="reopen-suggestion-btn" class="add-step-btn" style="background:white; color:var(--primary-color); border:1px solid var(--primary-color); padding:4px 10px; border-radius:6px; cursor:pointer; font-size:0.8rem;"><i class="fas fa-plus"></i> Th√™m ƒëi·ªÉm</button>
                </div>

                <div id="route-steps-container"></div>

                <button id="edit-route-btn" class="secondary-btn">
                    <i class="fas fa-arrow-left"></i> Ch·ªânh s·ª≠a l·∫°i
                </button>
            </div>
        </div>
    </div>

    <div id="suggestion-panel" class="is-visible">
        <div id="suggestion-header">
            <button id="toggle-suggestion-btn" title="Thu g·ªçn"><i class="fas fa-chevron-left"></i></button>
            <strong><i class="fas fa-lightbulb" style="color: #FFC107;"></i> ƒê·ªãa ƒëi·ªÉm g·ª£i √Ω</strong>
        </div>
        <div class="search-box-wrapper">
            <div class="input-wrapper">
                <i class="fas fa-search"></i>
                <input type="text" id="sidebar-search" placeholder="T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm...">
            </div>
        </div>
        <div id="suggestion-list" style="padding:0 20px 20px 20px; overflow-y:auto; flex:1;"></div>
    </div>

    <div id="big-map"></div>
    <button id="mobile-map-toggle"><i class="fas fa-expand-arrows-alt"></i></button>
    <button id="floating-back-btn"><i class="fas fa-arrow-left"></i></button>

    <div id="details-panel">
        <div id="details-header">
            <h2>Th√¥ng tin ƒë·ªãa ƒëi·ªÉm</h2>
            <button id="close-details-btn"><i class="fas fa-times"></i></button>
        </div>
        <div id="details-content" style="padding:24px; overflow-y:auto; flex:1;"></div>
    </div>

    <div id="chat-widget">
        <div class="chat-header">
            <i class="fas fa-robot" style="font-size: 1.5rem; color: var(--accent-color);"></i>
            <span>Tr·ª£ l√Ω Du l·ªãch AI</span>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="message msg-ai" style="background:#fff; padding:12px; border-radius: 12px 12px 12px 0; box-shadow: var(--shadow-sm); width: 85%;">
                Ch√†o b·∫°n! M√¨nh c√≥ th·ªÉ gi√∫p g√¨ cho chuy·∫øn ƒëi s·∫Øp t·ªõi? üéí
            </div>
        </div>
        <div class="typing-indicator" id="typing-indicator" style="padding: 0 20px; font-size: 0.8rem; color:#888; display:none;">AI ƒëang so·∫°n tin...</div>
        <div class="chat-footer">
            <input type="text" id="chat-input" placeholder="Nh·∫≠p tin nh·∫Øn...">
            <button id="send-msg-btn"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <button id="floating-chat-btn" title="Chat v·ªõi AI"><i class="fas fa-comment-alt"></i><i class="fas fa-times" style="display:none;"></i></button>

    <button id="hand-toggle-btn" title="ƒê·ªïi tay tr√°i/ph·∫£i">
        <i class="fas fa-hand-paper"></i>
    </button>
    <div id="mobile-quick-search" class="mobile-search-popup">
        <div class="mq-header">
            <i class="fas fa-search" style="color: #2D6A4F;"></i>
            <input type="text" id="mq-input" placeholder="Nh·∫≠p t√™n ƒë·ªãa ƒëi·ªÉm..." autocomplete="off">
            <button id="mq-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div id="mq-results">
            <div style="padding:15px; text-align:center; color:#999; font-size:0.85rem;">
                Nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ t√¨m ki·∫øm...
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="./env.js"></script>
    <script type="module" src="./js/main.js"></script>
    <script src="https://unpkg.com/mobile-drag-drop/index.min.js"></script>
    <script>
        MobileDragDrop.polyfill({ holdToDrag: 300, dragImageTranslateOverride: MobileDragDrop.scrollBehaviourDragImageTranslateOverride });
        window.addEventListener('touchmove', function () { }, { passive: false });
    </script>
</body>
</html>